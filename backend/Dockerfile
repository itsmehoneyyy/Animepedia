# ğŸ“¦ à¹ƒà¸Šà¹‰ Python slim image à¸—à¸µà¹ˆà¹€à¸šà¸²à¹à¸¥à¸°à¹€à¸£à¹‡à¸§
FROM python:3.11-slim

# âš™ï¸ à¸•à¸±à¹‰à¸‡ working directory à¹ƒà¸™ container
WORKDIR /app

# ğŸ§¾ Copy requirements.txt à¸ˆà¸²à¸ backend à¸¡à¸²à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¸à¹ˆà¸­à¸™
COPY requirements.txt .

# ğŸš€ à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
RUN pip install --upgrade pip && pip install -r requirements.txt

# ğŸ“ Copy à¹‚à¸„à¹‰à¸” backend à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” (à¸£à¸§à¸¡ animeproject, animeapp, users, etc.)
COPY . .

# ğŸŒ à¹€à¸›à¸´à¸”à¸à¸­à¸£à¹Œà¸• 8000 à¸ªà¸³à¸«à¸£à¸±à¸š Render à¸•à¸£à¸§à¸ˆà¹€à¸ˆà¸­
EXPOSE 8000

# ğŸ•’ à¸£à¸­ database, migrate, à¹à¸¥à¹‰à¸§à¸£à¸±à¸™ server
CMD ["sh", "-c", "python wait_for_db.py && python manage.py migrate && python manage.py runserver 0.0.0.0:8000"]
